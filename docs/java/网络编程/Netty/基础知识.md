
## Netty核心组件介绍


## 线程模型

### 单线程 `QPS<=5k`
所有I/O操作和业务逻辑由单个线程处理
```java
EventLoopGroup singleGroup = new NioEventLoopGroup(1); // 关键：线程数=1
ServerBootstrap b = new ServerBootstrap();
b.group(singleGroup)  // 单线程同时处理连接和I/O
 .channel(NioServerSocketChannel.class)
 .childHandler(new ChannelInitializer<SocketChannel>() {
     @Override
     protected void initChannel(SocketChannel ch) {
         ch.pipeline().addLast(new SimpleHandler());
     }
 });
```
### 多线程 `1w<=QPS<=3w`
一组线程共同处理所有Channel的I/O事件
```java
EventLoopGroup workerGroup = new NioEventLoopGroup(16); // 关键：多线程

ServerBootstrap b = new ServerBootstrap();
b.group(workerGroup)  // 所有线程平等处理连接和I/O
 .channel(NioServerSocketChannel.class)
 .childHandler(new ChannelInitializer<SocketChannel>() {
     @Override
     protected void initChannel(SocketChannel ch) {
         ch.pipeline().addLast(new SimpleHandler());
     }
 });
```
### 主从多线程 `QPS>5w`
分离连接接收（主线程组）和I/O处理（工作线程组）
```java
EventLoopGroup bossGroup = new NioEventLoopGroup(2);  // 主线程组：专责接收连接
EventLoopGroup workerGroup = new NioEventLoopGroup(16); // 工作线程组：处理I/O

ServerBootstrap b = new ServerBootstrap();
b.group(bossGroup, workerGroup)  // 关键：双线程组
 .channel(NioServerSocketChannel.class)
 .childHandler(new ChannelInitializer<SocketChannel>() {
     @Override
     protected void initChannel(SocketChannel ch) {
         ch.pipeline().addLast(new ComplexHandler()); // 复杂业务处理
     }
 });
```

## AttributeKey
